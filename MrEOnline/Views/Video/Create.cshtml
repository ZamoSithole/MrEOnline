@model MrE.Models.Entities.Video

@{
    ViewBag.Title = "Create";
}

<h2>Create</h2>
<script src="~/Scripts/lodash.js"></script>
@using (Html.BeginForm())
{
    @Html.AntiForgeryToken()

    <div class="form-horizontal">
        <h4>Video</h4>
        <hr />
        @Html.ValidationSummary(true, "", new { @class = "text-danger" })
        <div class="form-group">
            @Html.LabelFor(model => model.Title, htmlAttributes: new { @class = "control-label col-md-2" })
            <div class="col-md-10">
                @Html.EditorFor(model => model.Title, new { htmlAttributes = new { @class = "form-control" } })
                @Html.ValidationMessageFor(model => model.Title, "", new { @class = "text-danger" })
            </div>
        </div>

        <div class="form-group">
            @Html.LabelFor(model => model.Description, htmlAttributes: new { @class = "control-label col-md-2" })
            <div class="col-md-10">
                @Html.EditorFor(model => model.Description, new { htmlAttributes = new { @class = "form-control" } })
                @Html.ValidationMessageFor(model => model.Description, "", new { @class = "text-danger" })
            </div>
        </div>

        <div class="form-group required">
            <label class="control-label  col-md-2">Genre</label>
            <div class="col-md-10">
                @*@Html.DropDownListFor(m => m.GenreID, (ViewData["GenreSelectList"] as SelectList), "Select Option", htmlAttributes: new { @class = "form-control", @required = true })*@
                @*@Html.DropDownListFor(m => m.GenreID, ((SelectList)ViewData["GenreSelectList"]), "Select Option", htmlAttributes: new { @class = "form-control", @required = true })*@
                <select id="genre-select" name="GenreID" class="form-control" required></select>
                @Html.ValidationMessageFor(model => model.GenreID, "", new { @class = "text-danger" })
            </div>
        </div>

        <div class="form-group">
            @Html.LabelFor(model => model.RentalPrice, htmlAttributes: new { @class = "control-label col-md-2" })
            <div class="col-md-10">
                @Html.EditorFor(model => model.RentalPrice, new { htmlAttributes = new { @class = "form-control", @type = "number", @min = "0", @step = "0.01", @value = "0" } })
                @Html.ValidationMessageFor(model => model.RentalPrice, "", new { @class = "text-danger" })
            </div>
        </div>

        

        <div class="form-group">
            <div class="col-md-offset-2 col-md-10">
                <input type="submit" value="Create" class="btn btn-default" />
            </div>
        </div>
    </div>
}

<div>
    @Html.ActionLink("Back to List", "Index")
</div>
@section Scripts
{
    <script>
        //$(function () {
        //    debugger;
        //    $.ajax({
        //        url: "/Genre/GetGenres",
        //        Type:"POST",
        //        success: function (result) {
        //            alert(result);
        //        }
        //    })
        //});
        debugger;
 $.get('@Url.Action("GetGenres", "Genre")')
     .done(function (genres) {
                    $('#genre-select').empty().append("<option value=''>Select Genre</option>")
                        .append(
                        _.map(_.filter(genres, function (elem) {
                            //return elem.Name == "Approved" || elem.Name === "Rejected";
                        }), function (genre) {
                            return '<option value="' + genre.GenreID + '">' + genre.Name + '</option>';
                        })
                        );
                });
        //})

    </script>
}